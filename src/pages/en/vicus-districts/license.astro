---
import PageLayout from '../../../layouts/PageLayout.astro';
import SubNavigation from '../../../components/SubNavigation.astro';
import Testimonial from '../../../components/Testimonial.astro';
import { useTranslations, url } from '../../../i18n/utils';

const lang = 'en';
const t = useTranslations(lang);

const subNavItems = [
  { label: t('districts.overview'), href: url(`/${lang}/vicus-districts`) },
  { label: t('districts.features'), href: url(`/${lang}/vicus-districts/features`) },
  { label: t('districts.license'), href: url(`/${lang}/vicus-districts/license`) },
  { label: t('districts.onboarding'), href: url(`/${lang}/vicus-districts/onboarding`) },
  { label: t('districts.comparison'), href: url(`/${lang}/vicus-districts/comparison`) },
  { label: t('districts.faq'), href: url(`/${lang}/vicus-districts/faq`) },
];

// Feature comparison for Dynamic
const dynamicFeatures = [
  { feature: 'Import and export of GIS, PDF, DXF', values: [true, true, true] },
  { feature: 'Easy network planning and sizing', values: [true, true, true] },
  { feature: 'Steady-state pressure loss calculation', values: [true, true, true] },
  { feature: 'Multiple energy plants / heat sources', values: [false, true, true] },
  { feature: 'Thermo-hydraulic simulation', values: [true, true, true] },
  { feature: 'Determine heat losses / gains', values: [true, true, true] },
  { feature: 'Sizing of geothermal sources for low-temp networks', values: [true, true, true] },
  { feature: '3 hours onboarding with our expert team', values: [false, 'yes *', 'yes *'] },
  { feature: 'Maximum number of consumers', values: ['Up to 100', 'Up to 300', 'Up to 1,000 **'] },
  { feature: 'Price', values: ['€242/month', '€408/month', '€575/month'] },
];

// Feature comparison for Static
const staticFeatures = [
  { feature: 'Import and export of GIS, PDF, DXF', values: [true, true, true] },
  { feature: 'Easy network planning and sizing', values: [true, true, true] },
  { feature: 'Steady-state pressure loss calculation', values: [true, true, true] },
  { feature: 'Multiple energy plants / heat sources', values: [false, true, true] },
  { feature: 'Thermo-hydraulic simulation', values: [false, false, false] },
  { feature: 'Determine heat losses / gains', values: [false, false, false] },
  { feature: 'Sizing of geothermal sources for low-temp networks', values: [false, false, false] },
  { feature: '3 hours onboarding with our expert team', values: [false, 'yes *', 'yes *'] },
  { feature: 'Maximum number of consumers', values: ['Up to 100', 'Up to 300', 'Up to 1,000 **'] },
  { feature: 'Price', values: ['€125/month', 'coming soon', 'coming soon'] },
];
---

<PageLayout
  title="Pricing & Licenses | VICUS DISTRICTS"
  description="Flexible license models for VICUS DISTRICTS. From small projects to large district heating networks."
  showHero={false}
>
  <!-- Header -->
  <section class="pt-32 pb-8">
    <div class="container-custom">
      <h1 class="text-3xl md:text-4xl font-bold text-foreground mb-4">Pricing & Licenses</h1>
      <p class="text-xl text-foreground/70 max-w-3xl">
        Flexible license models for every project size. All licenses include the full software and regular updates.
      </p>
    </div>
  </section>

  <SubNavigation items={subNavItems} currentPath={Astro.url.pathname} />

  <!-- License Type Tabs -->
  <section class="section">
    <div class="container-custom">
      <!-- Tab Buttons -->
      <div class="flex justify-center mb-12">
        <div class="inline-flex rounded-lg border border-foreground/20 p-1 bg-secondary/30">
          <button
            id="tab-dynamic"
            class="license-tab px-6 py-3 rounded-md font-medium transition-all bg-primary text-background"
            data-tab="dynamic"
          >
            Dynamic Simulation
          </button>
          <button
            id="tab-static"
            class="license-tab px-6 py-3 rounded-md font-medium transition-all text-foreground/70 hover:text-foreground"
            data-tab="static"
          >
            Steady-State Calculation
          </button>
        </div>
      </div>

      <!-- Dynamic Pricing Content -->
      <div id="content-dynamic" class="license-content">
        <div class="text-center mb-8">
          <h2 class="text-2xl font-semibold text-foreground mb-2">Districts Dynamic</h2>
          <p class="text-foreground/70">With thermo-hydraulic annual simulation</p>
        </div>

        <!-- Feature Comparison Table -->
        <div class="overflow-x-auto">
          <table class="w-full border-collapse max-w-5xl mx-auto">
            <thead>
              <tr>
                <th class="text-left p-4 bg-secondary/50 border-b border-foreground/10 rounded-tl-lg">
                  <span class="text-foreground font-semibold">Features</span>
                </th>
                <th class="text-center p-4 bg-secondary/50 border-b border-foreground/10">
                  <div class="text-foreground font-semibold">Districts Dynamic</div>
                  <div class="text-primary text-sm">Basic</div>
                </th>
                <th class="text-center p-4 bg-secondary/50 border-b border-foreground/10">
                  <div class="text-foreground font-semibold">Districts Dynamic</div>
                  <div class="text-primary text-sm">Advanced</div>
                </th>
                <th class="text-center p-4 bg-secondary/50 border-b border-foreground/10 rounded-tr-lg">
                  <div class="text-foreground font-semibold">Districts Dynamic</div>
                  <div class="text-primary text-sm">Pro</div>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr class="bg-secondary/20">
                <td class="p-4 border-b border-foreground/5">
                  <span class="text-foreground/80">Typical application</span>
                </td>
                <td class="text-center p-4 border-b border-foreground/5 text-sm text-foreground/70">
                  Low-temp networks or small conventional heating networks
                </td>
                <td class="text-center p-4 border-b border-foreground/5 text-sm text-foreground/70">
                  Medium-sized heating networks
                </td>
                <td class="text-center p-4 border-b border-foreground/5 text-sm text-foreground/70">
                  District heating networks
                </td>
              </tr>
              {dynamicFeatures.map((item, rowIndex) => (
                <tr class:list={[rowIndex % 2 === 0 ? "bg-background" : "bg-secondary/20"]}>
                  <td class="p-4 border-b border-foreground/5">
                    <span class="text-foreground/80">{item.feature}</span>
                  </td>
                  {item.values.map((value) => (
                    <td class="text-center p-4 border-b border-foreground/5">
                      {typeof value === 'boolean' ? (
                        value ? (
                          <svg class="w-6 h-6 text-primary mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                          </svg>
                        ) : (
                          <svg class="w-6 h-6 text-red-500 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                          </svg>
                        )
                      ) : (
                        <span class:list={[
                          "text-foreground/80",
                          item.feature === 'Price' && "font-semibold text-foreground"
                        ]}>{value}</span>
                      )}
                    </td>
                  ))}
                </tr>
              ))}
            </tbody>
          </table>
        </div>

        <div class="mt-6 text-sm text-foreground/50 max-w-5xl mx-auto">
          <p>* Onboarding offer applies when purchasing an annual license.</p>
          <p>** For larger networks, we create an individual offer.</p>
        </div>

        <div class="mt-8 text-center">
          <a href={url(`/${lang}/contact`)} class="btn btn-primary">
            Request License
          </a>
        </div>
      </div>

      <!-- Static Pricing Content -->
      <div id="content-static" class="license-content hidden">
        <div class="text-center mb-8">
          <h2 class="text-2xl font-semibold text-foreground mb-2">Districts Static</h2>
          <p class="text-foreground/70">With steady-state calculation (without dynamic simulation)</p>
        </div>

        <!-- Feature Comparison Table -->
        <div class="overflow-x-auto">
          <table class="w-full border-collapse max-w-5xl mx-auto">
            <thead>
              <tr>
                <th class="text-left p-4 bg-secondary/50 border-b border-foreground/10 rounded-tl-lg">
                  <span class="text-foreground font-semibold">Features</span>
                </th>
                <th class="text-center p-4 bg-secondary/50 border-b border-foreground/10">
                  <div class="text-foreground font-semibold">Districts Static</div>
                  <div class="text-primary text-sm">Basic</div>
                </th>
                <th class="text-center p-4 bg-secondary/50 border-b border-foreground/10">
                  <div class="text-foreground font-semibold">Districts Static</div>
                  <div class="text-primary text-sm">Advanced</div>
                </th>
                <th class="text-center p-4 bg-secondary/50 border-b border-foreground/10 rounded-tr-lg">
                  <div class="text-foreground font-semibold">Districts Static</div>
                  <div class="text-primary text-sm">Pro</div>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr class="bg-secondary/20">
                <td class="p-4 border-b border-foreground/5">
                  <span class="text-foreground/80">Typical application</span>
                </td>
                <td class="text-center p-4 border-b border-foreground/5 text-sm text-foreground/70">
                  Low-temp networks or small conventional heating networks
                </td>
                <td class="text-center p-4 border-b border-foreground/5 text-sm text-foreground/70">
                  Medium-sized heating networks
                </td>
                <td class="text-center p-4 border-b border-foreground/5 text-sm text-foreground/70">
                  District heating networks
                </td>
              </tr>
              {staticFeatures.map((item, rowIndex) => (
                <tr class:list={[rowIndex % 2 === 0 ? "bg-background" : "bg-secondary/20"]}>
                  <td class="p-4 border-b border-foreground/5">
                    <span class="text-foreground/80">{item.feature}</span>
                  </td>
                  {item.values.map((value) => (
                    <td class="text-center p-4 border-b border-foreground/5">
                      {typeof value === 'boolean' ? (
                        value ? (
                          <svg class="w-6 h-6 text-primary mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                          </svg>
                        ) : (
                          <svg class="w-6 h-6 text-red-500 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                          </svg>
                        )
                      ) : (
                        <span class:list={[
                          "text-foreground/80",
                          item.feature === 'Price' && "font-semibold text-foreground",
                          value === 'coming soon' && "italic text-foreground/50"
                        ]}>{value}</span>
                      )}
                    </td>
                  ))}
                </tr>
              ))}
            </tbody>
          </table>
        </div>

        <div class="mt-6 text-sm text-foreground/50 max-w-5xl mx-auto">
          <p>* Onboarding offer applies when purchasing an annual license.</p>
          <p>** For larger networks, we create an individual offer.</p>
        </div>

        <div class="mt-8 text-center">
          <a href={url(`/${lang}/contact`)} class="btn btn-primary">
            Request License
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Academic License -->
  <section class="section bg-secondary/30">
    <div class="container-custom">
      <div class="max-w-3xl mx-auto">
        <div class="card bg-primary/10 border-primary/30">
          <div class="flex items-start gap-4">
            <div class="w-12 h-12 rounded-lg bg-primary/20 flex items-center justify-center flex-shrink-0">
              <svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z" />
              </svg>
            </div>
            <div>
              <h3 class="text-xl font-semibold text-foreground mb-2">Free Licenses for Education & Research</h3>
              <p class="text-foreground/70 mb-4">
                We provide free licenses for students, educators and research institutions.
                Ideal for courses, theses and research projects.
              </p>
              <a href={url(`/${lang}/contact`)} class="btn btn-primary">
                Request academic license
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Testimonial -->
  <section class="section">
    <div class="container-custom">
      <div class="max-w-4xl mx-auto">
        <Testimonial
          quote="VICUS DISTRICTS has significantly accelerated our project execution. The intuitive operation and precise simulation results convince us every day."
          author="Dr. Thomas Müller"
          role="Project Manager"
          company="Stadtwerke Meiningen"
        />
      </div>
    </div>
  </section>

  <!-- CTA -->
  <section class="section bg-secondary/30">
    <div class="container-custom text-center">
      <h2 class="text-foreground mb-4">Still have questions?</h2>
      <p class="text-xl text-foreground/70 max-w-2xl mx-auto mb-8">
        Our sales team will be happy to advise you on the various license options.
      </p>
      <div class="flex flex-wrap justify-center gap-4">
        <a href={url(`/${lang}/contact`)} class="btn btn-primary">
          {t('btn.contact')}
        </a>
        <a href={url(`/${lang}/vicus-districts/onboarding`)} class="btn btn-secondary">
          {t('districts.testLicense')}
        </a>
      </div>
    </div>
  </section>
</PageLayout>

<script>
  const tabs = document.querySelectorAll('.license-tab');
  const contents = document.querySelectorAll('.license-content');

  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      const targetTab = tab.getAttribute('data-tab');

      // Update tab styles
      tabs.forEach(t => {
        if (t.getAttribute('data-tab') === targetTab) {
          t.classList.add('bg-primary', 'text-background');
          t.classList.remove('text-foreground/70', 'hover:text-foreground');
        } else {
          t.classList.remove('bg-primary', 'text-background');
          t.classList.add('text-foreground/70', 'hover:text-foreground');
        }
      });

      // Update content visibility
      contents.forEach(content => {
        if (content.id === `content-${targetTab}`) {
          content.classList.remove('hidden');
        } else {
          content.classList.add('hidden');
        }
      });
    });
  });
</script>
