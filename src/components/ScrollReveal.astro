<!-- Scroll reveal animations using IntersectionObserver -->
<script>
  function initScrollReveal() {
    const elements = document.querySelectorAll('[data-scroll]');

    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          const el = entry.target as HTMLElement;
          const delay = parseInt(el.dataset.scrollDelay || '0');
          setTimeout(() => {
            el.classList.add('scroll-visible');
          }, delay);
          observer.unobserve(el);
        }
      });
    }, {
      threshold: 0.15,
      rootMargin: '0px 0px -40px 0px',
    });

    elements.forEach((el) => observer.observe(el));
  }

  // Run on initial load and after Astro page transitions
  initScrollReveal();
  document.addEventListener('astro:after-swap', initScrollReveal);
</script>

<style is:global>
  [data-scroll] {
    opacity: 0;
    transition: opacity 0.7s ease-out, transform 0.7s ease-out;
  }

  [data-scroll="up"] {
    transform: translateY(40px);
  }

  [data-scroll="down"] {
    transform: translateY(-40px);
  }

  [data-scroll="left"] {
    transform: translateX(-40px);
  }

  [data-scroll="right"] {
    transform: translateX(40px);
  }

  [data-scroll="scale"] {
    transform: scale(0.92);
  }

  [data-scroll].scroll-visible {
    opacity: 1;
    transform: translateY(0) translateX(0) scale(1);
  }

  /* Respect reduced motion preference */
  @media (prefers-reduced-motion: reduce) {
    [data-scroll] {
      opacity: 1;
      transform: none;
      transition: none;
    }
  }
</style>
